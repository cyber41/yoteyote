if(typeof(homepage)==="undefined"){
var seoFooterText = '<div id="ftrSec-advListingEmail">'
+ '<div id="ftrNav-theSonyStoreAdvantage" class="wrap">'
+ '<h4>The Sony Store Advantage</h4>'
+ '<ul>'
+ '<li class="first"><a id="btn-shopWithConfidence" rel="Shop with confidence" title="Shop with confidence" href="javascript:void(0);"><span></span>Shop with confidence</a></li>'
+ '<li><a id="btn-customizableComputers" rel="Customizable PCs" title="Customizable PCs" href="/webapp/wcs/stores/servlet/CategoryDisplay?catalogId=10551&storeId=10151&langId=-1&identifier=S_Notebooks&CSRT=7272775729582523944">'
+ '<span></span>Customizable PCs</a></li>'
+ '<li><a id="btn-ecoTrade" rel="Eco Trade" title="Trade-in program" href="/webapp/wcs/stores/servlet/ContentDisplayView?hideHeaderFooter=false&storeId=10151&catalogId=10551&langId=-1&cmsId=tradeup"><span class="ecoTrade"></span>Trade-in program</a></li>'
+ '<!-- Remove to accommodate holiday shipping calendar 	 '
+ '<li><a id="btn-sonyExperts" rel="Sony experts" title="Sony experts" href="/c/Backstage-Services/en/c/S_Backstage_PC">'
+ '<span></span>Sony experts</a></li>'
+ '-->'
+ '<li><a id="btn-sonyRewardsFooter" rel="Sony Rewards" title="Sony Rewards" href="/webapp/wcs/stores/servlet/SYDisplaySRPLandingPage?storeId=10151&langId=-1&catalogId=10551">'
+ '<span></span>Sony Rewards</a></li>'
+ '</ul>'
+ '</div>'
+ '<div id="ftrNav-listingEmailSignup" class="wrap">'
+ '<div class="column first">'
+ '<h4>Find a Retail Store</h4>'
+ '<ul><li><a id="btn-storeLocator" rel="Store Locator" title="Store Locator" href="/c/S_SonyStyle_Stores/en/c/S_SonyStyle_Stores">Store Locator</a></li>'
+ '<li><a id="btn-sonyRetailers" rel="Sony Dealers" title="Sony Dealers" href="/c/S_SonyStyleStore_Dealers/en/c/S_SonyStyleStore_Dealers">Sony Dealers</a></li>'
+ '</ul>'
+ '<h4>Shop</h4>'
+ '<ul>'
+ '<li><a href="/c/Sony-VAIO-Laptops-Computers-PCs/en/c/S_Notebooks">Laptops</a></li>'
+ '<li><a href="/c/All-In-One-Desktops/en/c/S_Desktops">Desktops</a></li>'
+ '<li><a href="/c/Sony-Tablets/en/c/S_tablet_landing">Tablets</a></li>'
+ '<li><a href="/c/Sony-Cell-Phones/en/c/S_Ericsson_Mobile_Phones">Mobile Phones</a></li>'
+ '<li><a href="/c/TVs-LED-LCD-3D-TV/en/c/S_Televisions">Televisions</a></li>'
+ '<li><a href="/c/Blu-ray-Disc-and-DVD-Players/en/c/S_Blu-Ray_Disc">Blu-ray Players</a></li>'
+ '<li><a href="/c/Cybershot-Digital-Cameras/en/c/S_Digital_Cameras">Cyber-shot Cameras</a></li>'
+ '<li><a href="/c/Sony-Alpha-NEX-Cameras-Accessories/en/c/S_NEX">NEX Cameras</a></li>'
+ '<li><a href="/c/Alpha-DSLR-Cameras-And-Accessories/en/c/S_Digital_SLR_Cameras">DSLR Cameras</a></li>'
+ '<li><a href="/webapp/wcs/stores/servlet/CategoryDisplay?catalogId=10551&storeId=10151&langId=-1&identifier=S_Headphones">Headphones</a></li>'
+ '</ul>'
+ '</div>'
+ '<div class="column">'
+ '<h4>Specialty Stores</h4>'
+ '<ul><li><a id="eduStoreGlobalFooterLink" rel="Footer_Directory_cta_ShopPlayStationMoveBundle" title="Education Store" href="/webapp/wcs/stores/servlet/SYPricingProgram?EPPToken=EDUCATION&EPPPin=SONYCAMPUS&storeId=10151&langId=-1&URL=ContentDisplayView?cmsId%3Dedu_landing_page%26catalogId%3D10551%26storeId%3D10151%26langId%3D-1">Education Store</a></li>'
+ '<li><a id="smbStoreGlobalFooterLink" rel="Business Store" title="Business Store" href="/webapp/wcs/stores/servlet/SYPricingProgram?EPPToken=EPP_SMB&langId=-1&storeId=10151&catalogId=10551&URL=ContentDisplayView?cmsId%3Dsmb_landing_page%26catalogId%3D10551%26storeId%3D10151%26langId%3D-1">Business Store</a></li>'
+ '</ul>'
+ '<h4>Payment &amp; Rewards</h4>'
+ '<ul><li><a href="/webapp/wcs/stores/servlet/SYDisplaySRPLandingPage?storeId=10151&langId=-1&catalogId=10551">Sony Rewards</a></li>'
+ '<li><a href="/webapp/wcs/stores/servlet/ContentDisplayView?cmsId=sony_card_main&catalogId=10551&storeId=10151&langId=-1">Sony Card</a></li>'
+ '<li><a href="/c/Special-Financing-Offers/en/c/sony_ge_financing">Sony Financing</a></li>'
+ '</ul>'
+ '<h4>Support Services</h4>'
+ '<ul><li><a href="/c/Backstage-Services/en/c/S_Backstage_PC">Premium Services</a></li>'
+ '<li><a href="/c/Installation-Services/en/c/S_INSTALL">In-home Installation</a></li>'
+ '<li><a href="/c/S_ESP/en/c/S_ESP">Extended Service Plans</a></li>'
+ '</ul>'
+ '</div>'
+ '<div class="column">'
+ '<h4>Order Support</h4>'
+ '<ul>'
+ '<li><a href="/webapp/wcs/stores/servlet/SYOrderStatusLandingView?storeId=10151&langId=-1&catalogId=10551">Order Status / Tracking</a></li>'
+ '<li><a target="_blank" href="http://esupport.sony.com/US/perl/model-accessories.pl">Customer Service</a></li>'
+ '<li><a target="_blank"href="http://esupport.sony.com/US/perl/support-info.pl?info_id=927#return_order_1">Returns</a></li>'
+ '<li><a target="_blank" href="http://esupport.sony.com/US/perl/support-info.pl?info_id=927">FAQs</a></li>'
+ '</ul>'
+ '<h4>Product Support</h4>'
+ '<ul>'
+ '<li><a target="_blank" href="https://forum.sel.sony.com/">Forums</a></li>'
+ '<li><a target="_blank" href="http://esupport.sony.com/US/perl/index.pl">Product Manuals</a></li>'
+ '<li><a target="_blank" href="https://productregistration.sel.sony.com/app/home.htm">Product Registration</a></li>'
+ '</ul>'
+ '<h4>Programs</h4>'
+ '<ul>'
+ '<li><a href="/webapp/wcs/stores/servlet/ContentDisplayView?hideHeaderFooter=false&storeId=10151&catalogId=10551&langId=-1&cmsId=sony_retailer_landing">Sony Authorized Dealer</a></li>'
+ '<li><a href="/webapp/wcs/stores/servlet/ContentDisplayView?cmsId=affiliate_program_main&storeId=10151&catalogId=10551&langId=-1">Affiliate Program</a></li>'
+ '</ul>'
+ '</div>'
+ '<div class="column last">'
+ '<h4>Savings and Special Offers</h4>'
+ '<ul>'
+ '<li><a id="ftrNav-onSale" rel="Deals" title="Deals" href="/c/S_Weekly_Deals/en/c/S_Weekly_Deals">Deals<span class="icon-saleTag spritable"></span></a></li>'
+ '<li><a href="/c/Sony-Outlet-Clearance-And-Refurbished-Products/en/c/S_Sony_Outlet">Outlet</a></li>'
+ '<li><a href="/webapp/wcs/stores/servlet/ContentDisplayView?hideHeaderFooter=false&storeId=10151&catalogId=10551&langId=-1&cmsId=tradeup">Trade-in &amp; Recycling Program</a></li>'
+ '</ul>'
+ '<div id="emailSignUpSection">'
+ '<h4>Special Offers</h4>'
+ '<form id="specialOffersForm" class="emailSubscribeForm" name="specialOffers" novalidate="novalidate">'
+ '<ul>'
+ '<li><label for="specialOffersEmail">Email:</label></li>'
+ '<li>'
+ '<input id="specialOffersEmail" type="textfield" required="required" data-message="Email is required.">'
+ '<p class="errorMessage"></p>'
+ '<input id="emailSignUpNewsletterInput" name="newsletter_0" type="hidden" value="10171">'
+ '</li>'
+ '<li><button id="specialOffersSubmit" class="cta emailSubscribe" type="submit" style="">Submit</button></li>'
+ '<li><a target="_blank" href="http://www.sonytextme.com/">Get the latest deals by text.</a></li>'
+ '</ul>'
+ '</form><!-- /form#specialOffersForm -->'
+ '<div id="specialOffersOverlay" class="emailSubscribeOverlay"><a class="close formContinue"></a>'
+ '<div class="overlayContent">'
+ '<div class="emailSubscribeMessage"></div>'
+ '<button class="formContinue cta" style="">Continue</button>'
+ '</div>'
+ '</div><!-- /#specialOffersOverlay -->'
+ '</div><!-- /#emailSignUpSection -->'
+ '</div> <!-- /.column -->'
+ '</div> <!-- /#ftrNav-listingEmailSignup -->'
+ '</div>'
+ '<!-- /#ftrSec-advListingEmail -->'
+ '<div id="ftrSec-storesSocialSGNLTerms">'
+ '<div id="ftrSec-storesShopByPhone">'
+ '<ul class="wrap">'
+ '<li>You are shopping in the US Sony Store</li>'
+ '<li class="note">US/APO/FPO shipping only</li>'
+ '<li id="shopByPhone">Shop by phone <span class="number">1-877-865-7669</span> <span class="flag">USA</span></li>'
+ '</ul>'
+ '</div> <!-- /#ftrSec-storesShopByPhone -->'
+ '<div id="ftrSec-socialEntertainmentSGNL" class="wrap">'
+ '<div class="left">'
+ '<div id="socialItems">'
+ '<h4>Connect</h4>'
+ '<ul>'
+ '<li><a target="_blank" id="twitter" class="spritable" href="http://twitter.com/SonyStore">Twitter</a></li>'
+ '<li><a target="_blank" id="blog" class="spritable" href="http://blog.sony.com/">Blog</a></li>'
+ '<li><a target="_blank" id="flickr" class="spritable" href="http://www.flickr.com/groups/sonycameraclub/">Flickr</a></li>'
+ '<li><a target="_blank" id="facebook" class="spritable" href="http://www.facebook.com/Sony">Facebook</a></li>'
+ '</ul>'
+ '</div> <!-- /#socialItmes -->'
+ '<div id="entertainmentItems">'
+ '<h4>Sony Entertainment Solutions</h4>'
+ '<ul>'
+ '<li><a target="_blank" target="_blank" href="http://www.sonyentertainmentnetwork.com/video-unlimited/">Video Unlimited</a></li>'
+ '<li><a target="_blank" href="http://www.sonyentertainmentnetwork.com/music-unlimited/">Music Unlimited</a></li>'
+ '<li><a target="_blank" href="http://us.playstation.com/psn/">Playstation Network</a></li>'
+ '<li><a target="_blank" href="http://ebookstore.sony.com/">Reader Bookstore</a></li>'
+ '<li><a href="/c/S_playmemories/en/c/S_playmemories">PlayMemories</a></li>'
+ '</ul>'
+ '</div> <!-- /#entertainmentItems -->'
+ '</div> <!-- /.left -->'
+ '<div id="SGNL" class="right">'
+ '<h4>SGNL - <span class="special">An in-depth look at Sony products</span></h4>'
+ '<ul class="videoThumbs">'
+ '<li>'
+ '<a class="videoOverlayTrigger trackImpression" href="http://www.youtube.com/watch?v=BI3fqGSSMY8" rel="Videos_1_SGNL" id="sgnlVideo01">'
+ '<span class="playButton">Watch:</span> <img src="/wcsstore/SonyStyleStorefrontAssetStore/img/ss_global/sgnl_video_1.jpg" alt="sgnl Video 01" width="149" height="83">'
+ '</a>'
+ '<p>LL Cool J, Grandmaster Flash and Sony Show Off Virtual Studio</p>'
+ '</li>'
+ '<li>'
+ '<a class="videoOverlayTrigger trackImpression" href="http://www.youtube.com/watch?v=YEY8rEQb8XQ" rel="Videos_2_SGNL" id="sgnlVideo02">'
+ '<span class="playButton">Watch:</span> <img src="/wcsstore/SonyStyleStorefrontAssetStore/img/ss_global/sgnl_video_2.jpg" alt="sgnl Video 02" width="149" height="83">'
+ '</a>'
+ '<p>EXCLUSIVE PREVIEW: New Sony Google TV Set-top Box</p>'
+ '</li>'
+ '<li class="last">'
+ '<a class="videoOverlayTrigger trackImpression" href="http://www.youtube.com/watch?v=ekclSvKtHRQ" rel="Videos_3_SGNL" id="sgnlVideo03">'
+ '<span class="playButton">Watch:</span> <img src="/wcsstore/SonyStyleStorefrontAssetStore/img/ss_global/sgnl_video_3.jpg" alt="sgnl Video 03" width="149" height="83">'
+ '</a>'
+ '<p>Exclusive! First Hands On with the Sony Cyber-shot&reg; RX100 Camera</p>'
+ '</li></ul>'
+ '</div> <!-- /#SGNL -->'
+ '<div class="clearfix"></div>'
+ '<p id="copyrightTerms">Copyright &copy; 2012 Sony Electronics Inc. All Rights Reserved.'
+ '<a id="termsOfServiceFooterLink" href="javascript:void(0);">Terms &amp; Conditions</a>  | '
+ '<a href="/webapp/wcs/stores/servlet/SYSiteMapView?storeId=10151&catalogId=10551&langId=-1">Sitemap</a>  | '
+ '<a target="_blank" href="https://products.sel.sony.com/SEL/legal/privacy.html">Privacy Policy/Your California Privacy Rights</a> | '
+ '<a target="_blank" href="https://sonystyle.custhelp.com/cgi-bin/sonystyle.cfg/php/enduser/doc_serve.php?&amp;5=70">Site Feedback</a>'
+ '<a target="_blank" id="corporateLogoFooter" href="http://www.sony.com">Sony.com</a>'
+ '</p>'
+ '</div> <!-- /#ftrSec-socialEntertainmentSGNL -->'
+ '</div>'
+ '<!-- Overlay Modal Container for Videos -->'
+ '<div id="videoOverlay" class="modalOverlay"><a class="close"></a>'
+ '<div class="overlayContent"></div>'
+ '</div>';

document.getElementById("footer").innerHTML = seoFooterText;

} // End the if to exclude this logic from homepage


if( typeof moduleSpace == 'undefined' ){ var moduleSpace = {}; }
if( typeof utilSpace == 'undefined' ){ var utilSpace = {}; }

var globalContext = {};
globalContext['boolDebug'] = false;
//use the globalContext namespace to store "global" variables and functions.
//example:  globalContext['myGlobalVar'] = myValue

// Function - globalContext.debugLog
// Description
//- arg0 = expects string log message
//- arg1(optional) = expects the "arguments" object of a function to serialize and display
//  This makes a simple logger available to all scripts rendered in the DOM
//  allows for objects that do not inherit from the moduleSpace to log to the console.
globalContext.debugLog = function( message, argsObj) {
	var serializedArguments = '';
	if(typeof(argsObj)=='undefined') {
		argsObj = {};
	} else {
		serializedArguments = 'args=' +Array.prototype.slice.call(argsObj)
	}
	if(globalContext['boolDebug']) {
		try {
			console.log(message + ' - ' + serializedArguments);
		} catch(e) {}
	}
}
globalContext.globalEventListeners = function() {
	$$('a.CTALink').invoke('observe','click',function(eventObj) {
		utilSpace.track.trackCMS(this);
		Event.stop(eventObj);
	});
	$$('a.internalCTA').invoke('observe','click',function(eventObj) {
		utilSpace.track.trackCMS(this);
		Event.stop(eventObj);
	});
	$$('a.externalCTA').invoke('observe','click',function(eventObj) {
		//if not target
		utilSpace.track.trackCMS(this);
		Event.stop(eventObj);
	});
	$$('.trackImpression').invoke('observe','click',function(eventObj) {
		if(typeof this.rel === "undefined"){
			utilSpace.track.trackImpression(this.id +'_'+this.getAttribute('rel'));
		}
		else{
			utilSpace.track.trackImpression(this.id +'_'+this.rel);
		}
		//Event.stop(eventObj);
	});
}

//shorthand alias for global debug function.
var debug = globalContext.debugLog;

// Class - moduleSpace.masterModule
// Description - This inits other modules
moduleSpace.masterModule = {
	_modules	: {},

	// Function - moduleSpace.masterModule.init
	init : function(){
		for( var module in moduleSpace ){
			if(module != 'genericModule'){
				moduleSpace[module].autoInit
				if(moduleSpace[module].autoInit){
					moduleSpace[module].init();
				}
			}
		}
	},

	// Function - moduleSpace.masterModule.registerModule
	registerModule : function(module){
		if( typeof this._modules[module._moduleName] == 'undefined' ){
			this._modules[module._moduleName] = [];
		}
	},

	// Function - moduleSpace.masterModule.registerInstance
	registerInstance : function(module){
		this.registerModule(module);
		this._modules[module._moduleName][this._modules[module._moduleName].length] = true;
		return module._moduleName + '.' + this._modules[module._moduleName].length;
	}
};

// Class - utilSpace.params
utilSpace.params = {
	_objParams:{},
	set: function(a,b) {
		var c, data={};
		if(typeof a._moduleName=='string'){
			c=this.getInstanceName(a._moduleName,b);
			for(var d in a) {
				( d[0]!='_' && typeof a[d]!='function' ) ? data[d]=a[d]:'';
				if(d[0]!='_'&&typeof a[d]!='function' && $($$('[data-instance='+b+']')[0]).readAttribute('data-'+d)!=null) {
					data[d]=$($$('[data-instance='+b+']')[0]).readAttribute('data-'+d)}
			}
			this._objParams[c]=data}
		},
	setVariable: function(a,b,c,d) {
		if(typeof a._moduleName=='string') {
			b=this.getInstanceName(a._moduleName,b);
			this._objParams[b][c]=d}
		},
	get: function(a,b) {
		if(typeof a._moduleName=='string') {
			b=this.getInstanceName(a._moduleName,b);
			return this._objParams[b]}
			return{}
		},
	getInstanceName:function(a,b){return b!=''?a+'."'+b+'"':a}
};

// Description - handles events between modules
// NOTE - 	if need to recompress, note that on the function 'dispatchEvent' the variables inside the eval which are strings need to be replaced by the newly shrunk variable name

utilSpace.events = {

	// Define the properties of the class
	_objRegisteredEvents	: {},

	registerEventListener : function(container,event,callback){
		var me = this;
		typeof me._objRegisteredEvents[event] == 'undefined' ? me._objRegisteredEvents[event] = [] : '';
		me._objRegisteredEvents[event].push( {container:container, callback:callback} );
	},

	dispatchEvent : function(event,arguments){
		var me = this;
		if( typeof me._objRegisteredEvents[event] != 'undefined' ){
			for( var i = 0; i < me._objRegisteredEvents[event].length; i++ ){
				eval( me._objRegisteredEvents[event][i].callback + '(me._objRegisteredEvents[event][i].container,arguments)' );
			}
		}
	}
};


// Class - utilSpace.track
// Description - omniture tracking
utilSpace.track = {

	// Omniture Function - utilSpace.track.trackImpression
	trackImpression:function (cmSpotName) {
		var me = this;
		debug('fn:trackImpression '+cmSpotName);
		try {
			clearOmniture(s);
			s=s_gi(s_account);
			s.linkTrackVars="prop29";
			s.linkTrackEvents="None";
			s.prop29=pageName+' > '+cmSpotName;
			s.tl(this,'o','RIA Links');
			if (debugMode) {
				window.open("","stats_debugger","width=600,height=600,location=0,menubar=0,status=1,toolbar=0,resizable=1,scrollbars=1").document.write("<script language=\"JavaScript\" src=\"http://192.168.112.2o7.net/stats_debugger.php\"></"+"script>" + "<script language=\"JavaScript\">window.focus();</script>");
			}
		} catch(e) {
			debug('EXCEPTION fn:trackImpression '+cmSpotName, e);
		}
	},

	// Omniture Function - utilSpace.track.trackCTA
	trackCTA: function (cmSpotName) {
		var me = this;
		debug(me,'fn:trackCTA '+cmSpotName);
		try {
			clearOmniture(s);
			s=s_gi(s_account);
			s.linkTrackVars="eVar10,prop29";
			s.linkTrackEvents="None";
			s.eVar10=pageName+' > '+cmSpotName;
			s.prop29=pageName+' > '+cmSpotName;
			s.tl(this,'o','RIA Links');
			if (debugMode) {
				window.open("","stats_debugger","width=600,height=600,location=0,menubar=0,status=1,toolbar=0,resizable=1,scrollbars=1").document.write("<script language=\"JavaScript\" src=http://store.sony.com/"http://192.168.112.2O7.net/stats_debugger.php/"></"+"script>" + "<script language=\"JavaScript\">window.focus();</script>");
			}
		} catch(e) {
			debug(me,'EXCEPTION fn:trackCTA '+cmSpotName, e);
		}
	},

	// Omniture Function - utilSpace.track.trackCMS
	// arguments  anchor object
	trackCMS: function(linkObj) {
		try {
			if(typeof(_cmspotObject)=='object') {
				_cmspotObject.trackCMSOmniture(linkObj.href, linkObj.id+'_'+linkObj.rel, linkObj.target == "_blank");
			}
		} catch(e) {
			debug('EXCEPTION fn:trackCMS ',{link:linkObj,exception:e});
		}
	}
};

// Class - moduleSpace.genericModule
// Description - Other modules extend this one
moduleSpace.genericModule = {
	autoInit	: true,
	modeDebug 	: false,
	_selector	: '',
	_moduleName	: '',

	// Function - moduleSpace.genericModule.init
	init : function(){
		var me = this;
		if(me.checkRequirements()){
			$$(me._selector).each(function(container){
				me.setup(container);
			});
		}
	},

	// Function - moduleSpace.genericModule.setup
	setup : function(container){
		var me = this, instanceName = me.getInstanceName();
		container.writeAttribute('data-instance', instanceName);
		me.log(container,'initInstance');
		me.setData(instanceName);
		me.setLayout(container);
		me.setActions(container);
	},

	// Function - moduleSpace.genericModule.getInstanceName
	getInstanceName : function(){
		return moduleSpace.masterModule.registerInstance(this);
	},

	// Function - moduleSpace.genericModule.checkRequirements
	checkRequirements : function(){
		return true;
	},

	// Function - moduleSpace.genericModule.setLayout
	setLayout : function(){},

	// Function - moduleSpace.genericModule.setActions
	setActions : function(){},

	// Function - moduleSpace.genericModule.setData
	setData : function(instanceName){
		utilSpace.params.set(this, instanceName);
	},

	// Function - moduleSpace.genericModule.getData
	getData : function(container){
		return utilSpace.params.get(this, container.readAttribute('data-instance'));
	},

	// Function - moduleSpace.genericModule.setDataByVariable
	setDataByVariable : function(container, name, value){
		utilSpace.params.setVariable(this, container.readAttribute('data-instance'), name, value);
	},

	// Function - moduleSpace.genericModule.getInstance
	getInstance : function(){
		var instance = {};
		for( var i in this ){ instance[i] = this[i]; }
		return instance;
	},

	// Function - moduleSpace.genericModule.registerEventListener
	registerEventListener : function(container, event, callback){
		utilSpace.events.registerEventListener(container, event, callback);
	},

	// Function - moduleSpace.genericModule.dispatchEvent
	dispatchEvent : function(event, arguments){
		utilSpace.events.dispatchEvent(event, arguments);
	},

	// Omniture Function - moduleSpace.genericModule.track
	track:function (cmSpotName) {
		utilSpace.track.trackImpression(cmSpotName);
		utilSpace.track.trackCTA(cmSpotName);
	},
	trackImpression:function(cmSpotName) {
		utilSpace.track.trackImpression(cmSpotName);

	},
	trackCTA:function(cmSpotName) {
		utilSpace.track.trackCTA(cmSpotName);
	},
	trackCMS:function(linkObj) {
		utilSpace.track.trackCMS(linkObj);
	},

	// Function - moduleSpace.genericModule.log
	log : function(container, message, argsObj) {
		var me = this;
		var serializedArguments = '';
		if(typeof(argsObj)=='undefined') { obj = {};} else {
			serializedArguments = 'args=' +Array.prototype.slice.call(argsObj)
		}

		if(me.modeDebug || globalContext.boolDebug) {
			try{
				//simple logger
				console.log(container.readAttribute('data-instance') + ' - ' + message + ' ' + serializedArguments);
			}catch(e){}
		}
	}
};



// Class - moduleSpace.packageLoader
// Description - Class/Object space that contains dynamic loading functions
//
// methods:
// jsLoad()
// -- arg0 : string | array - expects a file string or array of file strings
// -- arg1 : boolean - expects a boolean value true or false...if true then script will be loaded regardless if it exists already
/////////////////////////////////////////////
utilSpace.packageLoader =  {
	autoInit		: false,
	_moduleName 	: 'packageLoader',
	//package meta data will be indexed by the filename "ss_pkg_example" without the extension
	//holds two boolean variables   included  and loaded
	// included meands the loader has inserted into the dom
	// loaded indicates wether the package script executed successfully
	// object: can be array of files, or {folderRoot,jsFiles}
	packageRegistry : {},
	jsLoad : function() {
		var pkgList		= new Array(),
			folderRoot	= '',
			jsFiles		= [],

			defer 		= false;

		// input is string
		if(typeof arguments[0] == 'string') {
			jsFiles = arguments[0];
		}
		// input is array
		else if(arguments[0].constructor.toString().indexOf("Array") != -1 ){
			jsFiles = arguments[0];
		}
		// input is object
		else{
			folderRoot = arguments[0].folderRoot;
			jsFiles = arguments[0].jsFiles;
			defer 	= arguments[0].defer;
		}

		var boolReload = (typeof(arguments[1])=='undefined') ? false : arguments[1];

		if(jsFiles.length>0) {
			for(var i = 0; i < jsFiles.length; i ++){
				pkgName = jsFiles[i].indexOf('./') >= 0 ? jsFiles[i].substring(2, jsFiles[i].length) : folderRoot + jsFiles[i];
				//check to see if package has already been loaded
				//this lookup is an example of data directed programming
				if(typeof(this.packageRegistry[pkgName]=='undefined') || boolReload || !this.packageRegistry[pkgName] ) {
					var scriptElement=document.createElement('script');
					scriptElement.setAttribute("type","text/javascript");
					scriptElement.setAttribute("src", pkgName);
					if(defer==true) {
						scriptElement.setAttribute("defer", "defer");
					}
					document.getElementsByTagName("head")[0].appendChild(scriptElement);
					this.packageRegistry[pkgName] = true;
				}
			}
		}
	}
};

jQuery(document).ready(function() {
	if(typeof(homepage)==="undefined"){
		moduleSpace.masterModule.init();
		globalContext.globalEventListeners();
	}
});

/*
* 	Sony Autocomplete - Binds an input to jquery.ui autocomplete
*	PRECONDITION: jQuery.js 1.7.1, jQuery.ui 1.8.18 with autocomplete, jquery.ui.all.css
*/

if (jQuery('#WC_CachedSidebarDisplay_FormInput_searchTerm_In_CatalogSearchForm_1').length > 0)
{
	var searchBoxElement = jQuery('#WC_CachedSidebarDisplay_FormInput_searchTerm_In_CatalogSearchForm_1');
	if (searchBoxElement.val() == '' && !searchBoxElement.is(":focus") ){
    	searchBoxElement.focus();
	}

	// Prepopulate keyword field
	if (document.location.pathname.indexOf('SearchCatalog') != -1 || document.location.pathname.indexOf('StoreSearch') != -1 ) {
    	var keyword = '';
    	if (document.location.search.indexOf('keyword') != -1 ) {
        	keyword = document.location.search.match(/keyword=([^&]+)/)[1];
      	} else if (document.location.search.indexOf('Ntt') != -1 ) {
      		if(document.location.search.match(/Ntt=([^&]+)/) != null){
        		keyword = document.location.search.match(/Ntt=([^&]+)/)[1];
        	}
      	}

		//replace + with blank
		keyword = keyword.replace(/\u002b/gi," ");

		//replace unicode with its actual character representation
		var tempStr = "";
		var lastIdx = 0;
		var percentOccured = false;
		for(var i=0; i<keyword.length; i++){
			if(keyword.charAt(i) == '%'){
				percentOccured = true;
				tempStr += keyword.substring(lastIdx,i);
				tempStr += String.fromCharCode(parseInt("0x" + keyword.substr(i+1,2)));
				lastIdx = i+3;
				i=i+2;	//i+2 since i will be incremeneted by one in for loop.
			}
		}

		if(percentOccured == true) {
			keyword = tempStr + keyword.substring(lastIdx);
		}

      	searchBoxElement.val(keyword);
	}
}

// PJH fix for P1 defect saving passwords
jQuery("input[type=password]").attr("autocomplete", "off");

jQuery.widget( "custom.catcomplete", jQuery.ui.autocomplete, {
    _renderMenu: function( ul, items ) {
        var self = this;
        var currentCategory = "";
        jQuery.each( items, function( index, item ) {
            if ( item.category != currentCategory && item.category != "") {
                ul.append( "<li class='ui-autocomplete-category'>" + item.category + "</li>" );
                currentCategory = item.category;
            }
            self._renderItem( ul, item );
        });
    },
    _renderItem: function (ul, item) {
        item.label = item.label.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)(" + jQuery.ui.autocomplete.escapeRegex(this.term) + ")(?![^<>]*>)(?![^&;]+;)", "gi"), "<span class='wordMatched'>$1</span>");
        return jQuery("<li></li>")
                .data("item.autocomplete", item)
                .append( jQuery( "<a></a>" ).html( item.label ) )
                .appendTo(ul);
    }
});


jQuery(function () {
    var
		maxResultsDisplayed = 7,
        searchInput = jQuery("#WC_CachedSidebarDisplay_FormInput_searchTerm_In_CatalogSearchForm_1"),
        urlRoutePost = "/webapp/wcs/stores/servlet/SYSearchAjax",
        paramvalues = "&storeId=10151&langId=-1&catalogId=10551",
        autocompleteparams = paramvalues,
        placeHolderDisplay = searchInput.attr('data-prepoluate-field');
        autocompleteparams += "&Dx=mode+matchall+rel+static(depth,descending)";
        autocompleteparams += "&Dk=1";
    // Set Autocomplete
	searchInput.catcomplete({
		minLength: 3,
		delay: 0,
		source: function (request, response) {
			paramvalues = "keyword=" + request.term + autocompleteparams;
			counter = 0;

			jQuery.ajax({
			    url: urlRoutePost,
			    dataType: "json",
			    data: paramvalues,
			    success: function (data) {
				response(jQuery.map(data.ResultSet.suggestionList, function (item) {
					if(counter < maxResultsDisplayed){
						counter++;
						if(item.newWindow==undefined){
							item.newWindow=false
						}
					    return {
						originalLabel: item.value,
						label: item.value,
						_value: item.url,
						category: item.categoryname,
						newWindow: item.newWindow
					    }
					}
				 }));
			    },
			    error: function (data, context, xhr) {
				throw new Error("There was a problem retreiving the search request: " + xhr);
			    }
			});
		},
		focus: function(event, ui) {
		    searchInput.val(ui.item.originalLabel);
		    return false;
		},
		select: function(event, ui) {
		    searchInput.val(ui.item.originalLabel);
		    if(ui.item.newWindow==true){
					window.open(decodeURI(ui.item._value).replace(/&amp;/g, '&'));
		    }
		    else{
				var urlLocation = decodeURI(ui.item._value).replace(/&amp;/g, '&');
				if(urlLocation.indexOf("?") != -1){
					urlLocation = urlLocation + "&acdrop=1";
				}
				else{
					urlLocation = urlLocation + "?acdrop=1";
				}
				window.location.href = urlLocation;
		    }
		   return false;
		}

    });

    //prepopulate search input with default value 'SEARCH'
    if(searchInput) { jQuery(this).val(placeHolderDisplay); }

    //clear default value, focus state
    searchInput.focus( function(){
        jQuery("#sonyMenu a.toplevel").animate({
            'padding-right': '8px',
            'padding-left': '8px'
        }, 100);
        searchInput.animate({ "width": "157px" }, 100);
        if( jQuery(this).val() == placeHolderDisplay ){
        jQuery(this).val("");
      }
    });

    // if search input empty, restore default value, lose focus
    searchInput.blur(function(){
        searchInput.animate({ "width": "121px" }, 100);
        jQuery("#sonyMenu a.toplevel").animate({
            'padding-right': '10px',
            'padding-left': '10px'
        }, 100);
        if( jQuery(this).val() == '' ){
              jQuery(this).val(placeHolderDisplay);
        }
    });
    /* Populate shopping cart count on each page load */
    function populateShoppingCart(count) {
        var cartCount = count;
        if (cartCount==null || cartCount=='' || cartCount=="undefined") {cartCount=0;}
        return jQuery("#myCartCount").text(cartCount);
    };

    /* Flyout navigation */
    jQuery(document).ss_fancyMenu({ 'sensitivity' : 5, 'interval' : 100, 'timeout' : 800});

    if (jQuery.browser.msie) {
	  if( jQuery.browser.version == 7.0 ) { jQuery('body').addClass('ie7'); }
      if( jQuery.browser.version == 8.0 ) { jQuery('body').addClass('ie8'); }
      if( jQuery.browser.version == 9.0 ) { jQuery('body').addClass('ie9'); }
	}

    /* Email Signup form */
    var theErrorMessages = Array('Email is required.', 'Please enter a valid email address.');
    var specialOffersMessages = Array('Thank you for signing up! Welcome to the Sony family.', 'We recognize your e-mail address. Thanks for your interest! If you are not getting your e-mails, please check your email spam or trash folder.', 'Uh oh. We didn\'t recognize your email address please try again.');
    var theCurrentForm = Array();

    jQuery('button.emailSubscribe').on( 'click', function(evt) {
    	evt.preventDefault();
        theCurrentForm[0] = '#' + jQuery(this).closest('form').attr('id');
        theCurrentForm[1] = 'form' + theCurrentForm[0] + ' input[type=textfield], form' + theCurrentForm[0] + ' input[type=text]';
        theCurrentForm[2] = '#' + jQuery(theCurrentForm[1]).attr('id');
        theCurrentForm[3] = jQuery(theCurrentForm[1]).val();
        theCurrentForm[4] = theCurrentForm[0] + ' p.errorMessage';
        // Validate the Email Address
        validateEmail(theCurrentForm[3]);
    })

    // Binding the Email Subscription Submit Buttons.
    jQuery('.formContinue').on('click', function() {
        jQuery(theCurrentForm[3]).val('');
        closeEmailSubscribeMessageOverlay();
    });

    // Basic Email Validation Function.
    function validateEmail(theEmailAddress) {
        var emailRegEx = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
        if (theEmailAddress == '') {
            // There is no email address entered.
            removeValidationErrors();
            addValidationErrors(theErrorMessages[0]);
        } else if (!emailRegEx.test(theEmailAddress)) {
            // this is not a valid email
            removeValidationErrors();
            addValidationErrors(theErrorMessages[1]);
        } else {
            // this is a valid email so call the ajax.
            ajaxEmailSubscribe(theEmailAddress);
        }
    };

    // Adding the Error Messages to the Form
    // If the form is the #weeklyDealsForm we add the message to the input value.
    function addValidationErrors(theErrorMessage) {
        jQuery(theCurrentForm[2]).addClass('validationFailed');
        if (theCurrentForm[0] == '#signupForm') {
            //Add error message to email input value
            jQuery(theCurrentForm[2]).val(theErrorMessage);
            var theFormButton = theCurrentForm[0] + ' button';
            jQuery(theFormButton).addClass('validationFailed');
        } else {
            jQuery(theCurrentForm[4]).text(theErrorMessage);
            jQuery(theCurrentForm[4]).show();
        }
    };

    // Removes the validation Error Messages.
    function removeValidationErrors() {
        jQuery(theCurrentForm[2]).removeClass('validationFailed');
        if (theCurrentForm[0] == '#weeklyDealsForm') {
            jQuery(theCurrentForm[2]).val('');
            var theFormButton = theCurrentForm[0] + ' button';
            jQuery(theFormButton).removeClass('validationFailed');
        } else {
            jQuery(theCurrentForm[4]).text('');
            jQuery(theCurrentForm[4]).hide();
        }
    };

    // Shows the returned message from the server.
    function showEmailSubscribeMessageOverlay(emailSubscribeMessage) {
        removeValidationErrors();
        jQuery(theCurrentForm[0]).hide();
        jQuery(theCurrentForm[0]).parent().find('div.emailSubscribeMessage').html(emailSubscribeMessage);
        jQuery(theCurrentForm[0]).parent().find('.emailSubscribeOverlay').show();
        if (theCurrentForm[0] == '#weeklyDealsForm') { jQuery('#subscribe').addClass('white'); };
    };

    // Hides the returned message from the server.
    function closeEmailSubscribeMessageOverlay() {
        jQuery('form.emailSubscribeForm').show();
        jQuery('.emailSubscribeOverlay').hide();
        if (jQuery('#subscribe').hasClass('white')) { jQuery('#subscribe').removeClass('white'); };
    };

    // Parses the XML response from the server.
    function parseTheResponse(theResponse) {
        theResponse = jQuery(theResponse).find('response');
        theHeading = jQuery(theResponse).find(':header').text();
        theHeadingHTML = '<h4 class="emailSubscribeHeading">' + theHeading + '</h4>';
        if (jQuery(theResponse).find('p')) {
            theContent = jQuery(theResponse).find('p').text();
        }
        if (jQuery(theResponse).find('#signUpErrorNotification')) {
            theContent = jQuery(theResponse).find('#signUpErrorNotification').text();
        }
        theContentHTML = '<p class="emailSubscribeContent">' + theContent + '</p>';
        overlayMessage = theHeadingHTML + ' ' + theContentHTML;
        showEmailSubscribeMessageOverlay(overlayMessage);
    };

    // Ajax call to the server.
    function ajaxEmailSubscribe(theEmailAddress) {
        var theParams = 'emailAddress='+ theEmailAddress + '&newsletter_0=10171&zipCode=92127&storeId=10151&catalogId=10551&langId=-1';

        jQuery.ajax({
            type: 'POST',
            url: '/webapp/wcs/stores/servlet/SYQuickEmailAjaxSignUp',
            data: theParams,
            dataType: 'xml',
            success: function(theResponse){
                parseTheResponse(theResponse);
            },
            error: function(){
                showEmailSubscribeMessageOverlay(specialOffersMessages[2]);
            }
        });
    };

    jQuery('#genericEmailSignUpSection form.emailSubscribeForm').keydown(function(event) {
        if (event.keyCode == 13) { jQuery(this).find('button').click(); return false; }
    });

    if(jQuery.browser.msie) {
    	if(jQuery("#generic-mod-shippingInfoArea").length > 0){
			jQuery("#genericEmailSignUpEmailAddress").val(jQuery("#genericEmailSignUpEmailAddress").attr("placeholder"));
			jQuery("#genericEmailSignUpEmailAddress").click(function(){
				if(jQuery("#genericEmailSignUpEmailAddress").val() == jQuery("#genericEmailSignUpEmailAddress").attr("placeholder")){
				jQuery("#genericEmailSignUpEmailAddress").val("");
				}
			});
			jQuery("#genericEmailSignUpEmailAddress").blur(function(){
				if(jQuery("#genericEmailSignUpEmailAddress").val() == ""){
				jQuery("#genericEmailSignUpEmailAddress").val(jQuery("#genericEmailSignUpEmailAddress").attr("placeholder"));
				}
			});
		}
	}
	// For accessory Finder
	if(document.location.href.indexOf("SYAccessorySearch")>0){jQuery('.subCatTitle:contains("Discontinued")').closest('.subCatBox').remove();}

});

